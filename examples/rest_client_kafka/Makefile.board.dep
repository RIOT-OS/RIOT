# Put board specific dependencies here

ifneq (,$(filter arch_esp,$(FEATURES_USED)))
  USEMODULE += esp_wifi
else ifeq ($(BOARD),nucleo-f207zg)
  USEMODULE += stm32_eth_auto

  # Todo: How to choose maximum stack size when multiple transport protocols are used?
  # THREAD_STACKSIZE_DEFAULT = 1024
  # THREAD_STACKSIZE_MAIN = THREAD_STACKSIZE_DEFAULT + THREAD_EXTRA_STACKSIZE_PRINTF
  # THREAD_STACKSIZE_IDLE = 256
  # THREAD_EXTRA_STACKSIZE_PRINTF = 512
  # ISR_STACKSIZE = 512
  # TCPIP_THREAD_STACKSIZE = THREAD_STACKSIZE_DEFAULT
  # LWIP_NETDEV_STACKSIZE = THREAD_STACKSIZE_DEFAULT
  # GCOAP_STACK_SIZE = THREAD_STACKSIZE_DEFAULT + DEBUG_EXTRA_STACKSIZE + sizeof(coap_pkt_t) + GCOAP_DTLS_EXTRA_STACKSIZE
  # EVENT_THREAD_STACKSIZE_DEFAULT = ISR_STACKSIZE or THREAD_STACKSIZE_SMALL

  # Note: all these values are retrieved by the ps command under IPv6
  ifneq (0,$(TRANSPORT_COAP))
    CFLAGS += -DTHREAD_STACKSIZE_MAIN=4500
    CFLAGS += -DLWIP_NETDEV_STACKSIZE=210
    CFLAGS += -DTCPIP_THREAD_STACKSIZE=520
    CFLAGS += -DGCOAP_STACK_SIZE=490
  endif

  ifneq (0,$(TRANSPORT_COAP_SECURE))
    CFLAGS += -DTHREAD_STACKSIZE_MAIN=5120
    CFLAGS += -DLWIP_NETDEV_STACKSIZE=210
    CFLAGS += -DTCPIP_THREAD_STACKSIZE=520
    CFLAGS += -DGCOAP_STACK_SIZE=1730
  endif

  ifneq (0,$(TRANSPORT_MQTT))
    CFLAGS += -DTHREAD_STACKSIZE_MAIN=1700
    CFLAGS += -DLWIP_NETDEV_STACKSIZE=230
    CFLAGS += -DTCPIP_THREAD_STACKSIZE=590
  endif

  ifneq (0,$(TRANSPORT_MQTT_SN))
    CFLAGS += -DTHREAD_STACKSIZE_MAIN=1640
    CFLAGS += -DLWIP_NETDEV_STACKSIZE=210
    CFLAGS += -DTCPIP_THREAD_STACKSIZE=630
  endif

else ifeq ($(BOARD),native)
  USEMODULE += netdev_tap
else
  USEMODULE += netdev_default
endif
