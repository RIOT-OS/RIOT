#!/usr/bin/perl

# Copyright (c) 2021 Hugues Larrive <hlarrive@pm.me>
#
# This file is subject to the terms and conditions of the GNU Lesser
# General Public License v2.1. See the file LICENSE in the top level
# directory for more details.
#

open(OUTPUT, "> index.html.h");

print OUTPUT <<EOF;
/*
 * Copyright (C) 2021 Hugues Larrive <hlarrive\@pm.me>
 *
 * This file is subject to the terms and conditions of the GNU Lesser
 * General Public License v2.1. See the file LICENSE in the top level
 * directory for more details.
 */
/*
 * This file was autogenerated by the make_index_html_h script.
 */

#ifndef INDEX_HTML_H
#define INDEX_HTML_H

EOF

open(FILE, "index.html");

print(OUTPUT "static const char index_html[] = {\n");
$i = 0;
while(read(FILE, $data, 1)) {
    if($i == 0) {
        print(OUTPUT "    ");
    }
    printf(OUTPUT "%#04x,", unpack("C", $data));
    $i++;
    if($i == 11) {
        print(OUTPUT "\n");
        $i = 0;
    }
    else {
        print(OUTPUT " ");
    }
}
if ($i == 0) {
    print(OUTPUT "    0x00\n");
}
else {
    print(OUTPUT "0x00\n");
}
print(OUTPUT "};\n\n#endif /* INDEX_HTML_H */\n");
close(FILE);
