\hypertarget{group__drivers__hcsr04}{}\section{H\+C-\/\+S\+R04}
\label{group__drivers__hcsr04}\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}


This is a sensor which uses ultrasonic waves in order to measure the distance.  


\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{hcsr04_8c}{hcsr04.\+c}
\begin{DoxyCompactList}\small\item\em Device driver implementation for the H\+C-\/\+S\+R04. \end{DoxyCompactList}\item 
file \hyperlink{hcsr04__constants_8h}{hcsr04\+\_\+constants.\+h}
\begin{DoxyCompactList}\small\item\em Internal addresses, registers and constants. \end{DoxyCompactList}\item 
file \hyperlink{hcsr04__params_8h}{hcsr04\+\_\+params.\+h}
\begin{DoxyCompactList}\small\item\em Default configuration. \end{DoxyCompactList}\item 
file \hyperlink{hcsr04_8h}{hcsr04.\+h}
\end{DoxyCompactItemize}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structhcsr04__params__t}{hcsr04\+\_\+params\+\_\+t}
\begin{DoxyCompactList}\small\item\em Device initialization parameters for hcsr04 sensor. \end{DoxyCompactList}\item 
struct \hyperlink{structhcsr04__t}{hcsr04\+\_\+t}
\begin{DoxyCompactList}\small\item\em Device descriptor of a H\+C-\/\+S\+R04 sensor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{group__drivers__hcsr04_gabcca3ead68bf012ae42e185e070cb764}{hcsr04\+\_\+init} (\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$dev, const \hyperlink{structhcsr04__params__t}{hcsr04\+\_\+params\+\_\+t} $\ast$params)
\begin{DoxyCompactList}\small\item\em Initialize an H\+C-\/\+S\+R04 sensor. \end{DoxyCompactList}\item 
void \hyperlink{group__drivers__hcsr04_gabbfe6e650342e8cc67cf9c9e81b29335}{hcsr04\+\_\+trigger} (\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$dev)
\begin{DoxyCompactList}\small\item\em Starts a measurement by triggering the H\+C-\/\+S\+R04 device. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{group__drivers__hcsr04_ga449b9d4dc30d3d87d9ee4d8936fb592d}{hcsr04\+\_\+read} (\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$dev)
\begin{DoxyCompactList}\small\item\em Gets the last measurement reading. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{group__drivers__hcsr04_ga3b2547facab2613e3113c2fd5d2bd6a8}{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed} (uint16\+\_\+t temp)
\begin{DoxyCompactList}\small\item\em Function that calculates the speed of sound. \end{DoxyCompactList}\item 
void \hyperlink{group__drivers__hcsr04_gad5a6694b723bb25fc48e7a8750b8a77a}{hcsr04\+\_\+set\+\_\+temp} (\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$dev, uint16\+\_\+t new\+\_\+temp)
\begin{DoxyCompactList}\small\item\em Function that sets the temperature. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{group__drivers__hcsr04_gabef54fa09a72a7aa863aaa03b662125b}{hcsr04\+\_\+get\+\_\+distance} (\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$dev)
\begin{DoxyCompactList}\small\item\em Function that measures the current distance. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This is a sensor which uses ultrasonic waves in order to measure the distance. 



\subsection{Function Documentation}
\mbox{\Hypertarget{group__drivers__hcsr04_gabef54fa09a72a7aa863aaa03b662125b}\label{group__drivers__hcsr04_gabef54fa09a72a7aa863aaa03b662125b}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+get\+\_\+distance@{hcsr04\+\_\+get\+\_\+distance}}
\index{hcsr04\+\_\+get\+\_\+distance@{hcsr04\+\_\+get\+\_\+distance}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+get\+\_\+distance()}{hcsr04\_get\_distance()}}
{\footnotesize\ttfamily uint16\+\_\+t hcsr04\+\_\+get\+\_\+distance (\begin{DoxyParamCaption}\item[{\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$}]{dev }\end{DoxyParamCaption})}



Function that measures the current distance. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em arg} & Device descriptor of the driver\\
\hline
\end{DoxyParams}
Internally it calls the \hyperlink{group__drivers__hcsr04_gabbfe6e650342e8cc67cf9c9e81b29335}{hcsr04\+\_\+trigger} \& \hyperlink{group__drivers__hcsr04_ga449b9d4dc30d3d87d9ee4d8936fb592d}{hcsr04\+\_\+read} with the ideal minimum time interval based on the datasheet \mbox{\Hypertarget{group__drivers__hcsr04_gabcca3ead68bf012ae42e185e070cb764}\label{group__drivers__hcsr04_gabcca3ead68bf012ae42e185e070cb764}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+init@{hcsr04\+\_\+init}}
\index{hcsr04\+\_\+init@{hcsr04\+\_\+init}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+init()}{hcsr04\_init()}}
{\footnotesize\ttfamily int hcsr04\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$}]{dev,  }\item[{const \hyperlink{structhcsr04__params__t}{hcsr04\+\_\+params\+\_\+t} $\ast$}]{params }\end{DoxyParamCaption})}



Initialize an H\+C-\/\+S\+R04 sensor. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em dev} & Device descriptor of the driver \\
\hline
\mbox{\tt in}  & {\em params} & Initialization parameters\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+IO of invalid parameters 

E\+C\+ON if connection issue is detected 

0 on success
\end{DoxyReturn}
After called it checks the parameters, calculates the sound speed based on the default temperature, initializes the hardware and performs a check reading to see if the sensor\textquotesingle{}s echo pin works \mbox{\Hypertarget{group__drivers__hcsr04_ga449b9d4dc30d3d87d9ee4d8936fb592d}\label{group__drivers__hcsr04_ga449b9d4dc30d3d87d9ee4d8936fb592d}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+read@{hcsr04\+\_\+read}}
\index{hcsr04\+\_\+read@{hcsr04\+\_\+read}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+read()}{hcsr04\_read()}}
{\footnotesize\ttfamily uint16\+\_\+t hcsr04\+\_\+read (\begin{DoxyParamCaption}\item[{\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$}]{dev }\end{DoxyParamCaption})}



Gets the last measurement reading. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em dev} & Device descriptor of the driver\\
\hline
\end{DoxyParams}
This function returns the distance in milli meters

\begin{DoxyWarning}{Warning}
Before read a value \hyperlink{group__drivers__hcsr04_gabbfe6e650342e8cc67cf9c9e81b29335}{hcsr04\+\_\+trigger} has to be called
\end{DoxyWarning}
\begin{DoxyNote}{Note}
This function will retrieve the calculated distance after the last trigger 
\end{DoxyNote}
\mbox{\Hypertarget{group__drivers__hcsr04_gad5a6694b723bb25fc48e7a8750b8a77a}\label{group__drivers__hcsr04_gad5a6694b723bb25fc48e7a8750b8a77a}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+set\+\_\+temp@{hcsr04\+\_\+set\+\_\+temp}}
\index{hcsr04\+\_\+set\+\_\+temp@{hcsr04\+\_\+set\+\_\+temp}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+set\+\_\+temp()}{hcsr04\_set\_temp()}}
{\footnotesize\ttfamily void hcsr04\+\_\+set\+\_\+temp (\begin{DoxyParamCaption}\item[{\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$}]{dev,  }\item[{uint16\+\_\+t}]{new\+\_\+temp }\end{DoxyParamCaption})}



Function that sets the temperature. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em arg} & Device descriptor of the driver \\
\hline
\mbox{\tt in,out}  & {\em new\+\_\+temp} & New temperature in mili Celsious\\
\hline
\end{DoxyParams}
Internally it calls \hyperlink{group__drivers__hcsr04_ga3b2547facab2613e3113c2fd5d2bd6a8}{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed} to calculate the speed of sound so the distance calculation is more accurate \mbox{\Hypertarget{group__drivers__hcsr04_ga3b2547facab2613e3113c2fd5d2bd6a8}\label{group__drivers__hcsr04_ga3b2547facab2613e3113c2fd5d2bd6a8}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed@{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed}}
\index{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed@{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed()}{hcsr04\_temp\_to\_sound\_speed()}}
{\footnotesize\ttfamily uint16\+\_\+t hcsr04\+\_\+temp\+\_\+to\+\_\+sound\+\_\+speed (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{temp }\end{DoxyParamCaption})}



Function that calculates the speed of sound. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em temp} & Temperature in mili Celsious\\
\hline
\end{DoxyParams}
It uses the following formula\+: v = s $\ast$ sqrt(1 + T/\+To) Where\+:
\begin{DoxyItemize}
\item s is the speed of sound at 0 Celsious or 273 Kelvin
\item T is the given air temperature
\item To is the reference temperature 273 Kelvin
\end{DoxyItemize}

\begin{DoxyWarning}{Warning}
Temperature must be given in milli Celsious 
\end{DoxyWarning}
\mbox{\Hypertarget{group__drivers__hcsr04_gabbfe6e650342e8cc67cf9c9e81b29335}\label{group__drivers__hcsr04_gabbfe6e650342e8cc67cf9c9e81b29335}} 
\index{H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}!hcsr04\+\_\+trigger@{hcsr04\+\_\+trigger}}
\index{hcsr04\+\_\+trigger@{hcsr04\+\_\+trigger}!H\+C-\/\+S\+R04@{H\+C-\/\+S\+R04}}
\subsubsection{\texorpdfstring{hcsr04\+\_\+trigger()}{hcsr04\_trigger()}}
{\footnotesize\ttfamily void hcsr04\+\_\+trigger (\begin{DoxyParamCaption}\item[{\hyperlink{structhcsr04__t}{hcsr04\+\_\+t} $\ast$}]{dev }\end{DoxyParamCaption})}



Starts a measurement by triggering the H\+C-\/\+S\+R04 device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em dev} & Device descriptor of the driver \\
\hline
\end{DoxyParams}
